{
  "entities": {
    "UserProfile": {
      "title": "User Profile",
      "description": "Represents a user's profile in the system.",
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "The user's full name."
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "The user's email address."
        },
        "photoURL": {
          "type": "string",
          "format": "uri",
          "description": "URL of the user's profile picture."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp when the user account was created."
        },
        "formationId": {
          "type": "string",
          "description": "The ID of the formation the user is associated with (e.g., 'python', 'sante')."
        },
        "moduleLevel": {
          "type": "string",
          "description": "The user's level in the module, e.g., 'debutant'."
        },
        "friends": {
          "type": "array",
          "items": { "type": "string" },
          "description": "List of user UIDs who are friends with this user."
        },
        "status": {
          "type": "string",
          "enum": ["actif", "suspendu"],
          "description": "The current status of the user account."
        },
        "infractions": {
            "type": "number",
            "description": "A count of user infractions against community guidelines."
        }
      },
      "required": [
        "name",
        "email",
        "createdAt"
      ]
    },
    "InstructorProfile": {
        "title": "Instructor Profile",
        "description": "Extends UserProfile with instructor-specific fields.",
        "type": "object",
        "allOf": [{ "$ref": "#/entities/UserProfile" }],
        "properties": {
            "specialite": {
                "type": "string",
                "description": "The instructor's area of specialization."
            },
            "headline": {
                "type": "string",
                "description": "A professional headline for the instructor."
            }
        }
    },
    "Category": {
        "title": "Category",
        "description": "Represents a course category.",
        "type": "object",
        "properties": {
            "name": {
                "type": "string",
                "description": "The name of the category."
            },
            "description": {
                "type": "string",
                "description": "A short description of the category."
            },
            "createdAt": {
              "type": "string",
              "format": "date-time"
            }
        },
        "required": ["name", "description", "createdAt"]
    },
    "Course": {
      "title": "Formation (Course)",
      "description": "Represents a course on the platform.",
      "type": "object",
      "properties": {
        "title": {
          "type": "string"
        },
        "summary": {
            "type": "string"
        },
        "categoryId": {
          "type": "string"
        },
        "keywords": {
          "type": "array",
          "items": { "type": "string" }
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time"
        }
      },
      "required": [
        "title",
        "summary",
        "categoryId",
        "createdAt",
        "updatedAt"
      ]
    },
    "Module": {
        "title": "Module",
        "description": "Represents a module within a course.",
        "type": "object",
        "properties": {
            "title": { "type": "string" },
            "summary": { "type": "string" },
            "order": { "type": "number" },
            "createdAt": { "type": "string", "format": "date-time" },
            "updatedAt": { "type": "string", "format": "date-time" }
        },
        "required": ["title", "order", "createdAt", "updatedAt"]
    },
    "Video": {
        "title": "Video",
        "description": "Represents a video within a module.",
        "type": "object"
        ,
        "properties": {
            "title": { "type": "string" },
            "duration": { "type": "number" },
            "driveUrl": { "type": "string", "format": "uri" },
            "storagePath": { "type": "string" },
            "order": { "type": "number" },
            "createdAt": { "type": "string", "format": "date-time" },
            "published": { "type": "boolean" }
        },
        "required": ["title", "order", "createdAt", "published"]
    },
    "CourseProgress": {
      "title": "Course Progress",
      "description": "Tracks a user's progress in a specific course.",
      "type": "object",
      "properties": {
        "courseId": {
          "type": "string",
          "description": "The ID of the course."
        },
        "userId": {
          "type": "string",
          "description": "The ID of the user."
        },
        "progressPercentage": {
          "type": "number",
          "description": "The completion percentage of the course."
        },
        "lastUpdated": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp when the progress was last updated."
        },
        "courseTitle": {
          "type": "string",
          "description": "The title of the course, denormalized for easy display."
        }
      },
      "required": [
        "courseId",
        "userId",
        "progressPercentage",
        "lastUpdated",
        "courseTitle"
      ]
    },
     "Enrollment": {
      "title": "Enrollment",
      "description": "Represents a student's enrollment in a course.",
      "type": "object",
      "properties": {
        "studentId": {
          "type": "string",
          "description": "The UID of the enrolled student."
        },
        "studentName": {
            "type": "string",
            "description": "The name of the student for easy display."
        },
        "courseId": {
          "type": "string",
          "description": "The ID of the course."
        },
        "courseTitle": {
            "type": "string",
            "description": "The title of the course for easy display."
        },
        "enrollmentDate": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp of the enrollment."
        }
      },
      "required": ["studentId", "studentName", "courseId", "courseTitle", "enrollmentDate"]
    },
    "Donation": {
      "title": "Donation",
      "description": "Represents a donation made on the platform.",
      "type": "object",
      "properties": {
        "donateurId": {
          "type": "string",
          "description": "The UID of the user who made the donation."
        },
        "donateurNom": {
          "type": "string",
          "description": "The name of the donor."
        },
        "donateurEmail": {
          "type": "string",
          "format": "email",
          "description": "The email of the donor."
        },
        "montant": {
          "type": "number",
          "description": "The amount of the donation."
        },
        "devise": {
          "type": "string",
          "description": "The currency of the donation (e.g., EUR, XAF)."
        },
        "date": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp of the donation."
        },
        "statut": {
          "type": "string",
          "enum": ["succes", "en_attente", "echec"],
          "description": "The status of the donation transaction."
        },
        "moyenPaiement": {
          "type": "string",
          "enum": ["carte", "mobile_money", "inconnu"],
          "description": "The payment method used for the donation."
        },
        "paysOrigine": {
          "type": "string",
          "description": "The country of origin of the donor."
        }
      },
      "required": ["donateurId", "donateurNom", "donateurEmail", "montant", "devise", "date", "statut"]
    },
    "UserActivityLog": {
        "title": "User Activity Log",
        "description": "Tracks important actions performed by users.",
        "type": "object",
        "properties": {
            "userId": { "type": "string", "description": "The UID of the user who performed the action." },
            "name": { "type": "string", "description": "The name of the user." },
            "role": { "type": "string", "description": "The role of the user at the time of action." },
            "action": { "type": "string", "description": "The type of action performed (e.g., 'connexion', 'publication_cours')." },
            "details": { "type": "string", "description": "A descriptive text of the action." },
            "timestamp": { "type": "string", "format": "date-time" },
            "status": { "type": "string", "enum": ["succes", "echec"], "description": "The outcome of the action." }
        },
        "required": ["userId", "name", "role", "action", "timestamp", "status"]
    },
    "AdminNotification": {
        "title": "Admin Notification",
        "description": "Represents a notification for platform administrators.",
        "type": "object",
        "properties": {
            "type": {
                "type": "string",
                "enum": ["nouveau_cours", "nouveau_paiement", "nouvelle_inscription", "modification_profil", "demande_validation", "possible_scam"],
                "description": "The type of event that triggered the notification."
            },
            "title": { "type": "string", "description": "A short, descriptive title for the notification." },
            "message": { "type": "string", "description": "A detailed message explaining the event." },
            "createdAt": { "type": "string", "format": "date-time" },
            "read": { "type": "boolean", "description": "Whether the notification has been read by an admin." },
            "link": { "type": "string", "format": "uri", "description": "A direct link to the relevant resource (e.g., a course or a user profile)." }
        },
        "required": ["type", "title", "message", "createdAt", "read"]
    },
    "InstructorRequest": {
      "title": "Instructor Request",
      "description": "A student's request to become an instructor.",
      "type": "object",
      "properties": {
        "userId": {
          "type": "string",
          "description": "The UID of the user making the request."
        },
        "userName": {
          "type": "string",
          "description": "The name of the user."
        },
        "userEmail": {
          "type": "string",
          "format": "email",
          "description": "The email of the user."
        },
        "requestDate": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of the request."
        },
        "status": {
          "type": "string",
          "enum": ["pending", "approved", "rejected"],
          "description": "The status of the request."
        }
      },
      "required": ["userId", "userName", "userEmail", "requestDate", "status"]
    },
    "CommunityPost": {
      "title": "Community Post",
      "description": "Represents a discussion post in the community forum.",
      "type": "object",
      "properties": {
        "title": { "type": "string", "description": "The title of the discussion post." },
        "content": { "type": "string", "description": "The main content of the post." },
        "authorId": { "type": "string", "description": "The UID of the user who created the post." },
        "authorName": { "type": "string", "description": "The name of the user who created the post." },
        "authorImage": { "type": "string", "format": "uri", "description": "URL of the author's profile picture." },
        "tags": { "type": "array", "items": { "type": "string" }, "description": "Tags associated with the post." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp when the post was created." },
        "commentCount": { "type": "number", "description": "Number of comments on the post." },
        "voteCount": { "type": "number", "description": "Number of upvotes on the post." },
        "formationId": { "type": "string", "description": "ID of the formation this post belongs to." }
      },
      "required": ["title", "content", "authorId", "authorName", "createdAt", "commentCount", "voteCount", "formationId"]
    },
    "FriendRequest": {
      "title": "Friend Request",
      "description": "Represents a request from one user to befriend another.",
      "type": "object",
      "properties": {
        "from": {
          "type": "string",
          "description": "The UID of the user sending the request."
        },
        "to": {
          "type": "string",
          "description": "The UID of the user receiving the request."
        },
        "status": {
          "type": "string",
          "enum": ["pending", "accepted", "declined"],
          "description": "The status of the friend request."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the request was sent."
        }
      },
      "required": ["from", "to", "status", "createdAt"]
    },
    "Chat": {
      "title": "Chat",
      "description": "Represents a private conversation between two or more users.",
      "type": "object",
      "properties": {
        "members": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Array of UIDs of the members of this chat."
        },
        "lastMessage": {
          "type": "string",
          "description": "The content of the last message sent in the chat."
        },
        "lastTimestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of the last message."
        },
        "unreadCounts": {
          "type": "object",
          "additionalProperties": { "type": "number" },
          "description": "Map of user UIDs to their unread message count in this chat."
        },
        "formationId": {
            "type": "string",
            "description": "ID of the formation this chat belongs to."
        }
      },
      "required": ["members", "lastTimestamp", "formationId"]
    },
    "Message": {
      "title": "Message",
      "description": "Represents a single message within a chat.",
      "type": "object",
      "properties": {
        "from": {
          "type": "string",
          "description": "The UID of the user who sent the message."
        },
        "text": {
          "type": "string",
          "description": "The text content of the message."
        },
        "attachments": {
          "type": "array",
          "items": { "type": "string", "format": "uri" },
          "description": "List of URLs for any attachments (images, files)."
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the message was sent."
        },
        "seen": {
          "type": "boolean",
          "description": "Indicates if the message has been seen by the recipient(s)."
        }
      },
      "required": ["from", "text", "timestamp", "seen"]
    },
    "Notification": {
      "title": "Notification",
      "description": "Represents a notification for a user.",
      "type": "object",
      "properties": {
        "toUid": { "type": "string", "description": "The UID of the user receiving the notification." },
        "fromUid": { "type": "string", "description": "The UID of the user who triggered the notification." },
        "type": { "type": "string", "enum": ["friend_request", "new_message", "course_update", "moderation_warning"], "description": "The type of notification." },
        "payload": { "type": "object", "description": "Additional data related to the notification." },
        "read": { "type": "boolean", "description": "Whether the notification has been read." },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": ["toUid", "fromUid", "type", "read", "createdAt"]
    },
    "GroupChat": {
      "title": "Group Chat",
      "description": "Represents a group conversation for a specific formation.",
      "type": "object",
      "properties": {
        "formationId": {
          "type": "string",
          "description": "The ID of the formation this group chat belongs to."
        },
        "name": {
          "type": "string",
          "description": "The name of the group chat (e.g., 'Communaut√© Python')."
        },
        "description": {
          "type": "string",
          "description": "A short description of the group chat's purpose."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the group chat was created."
        }
      },
      "required": ["formationId", "name", "createdAt"]
    },
    "GroupMessage": {
      "title": "Group Message",
      "description": "Represents a single message within a group chat.",
      "type": "object",
      "properties": {
        "authorId": {
          "type": "string",
          "description": "The UID of the user who sent the message."
        },
        "authorName": {
          "type": "string",
          "description": "The name of the user, denormalized for easy display."
        },
        "authorImage": {
          "type": "string",
          "format": "uri",
          "description": "URL of the author's profile picture."
        },
        "text": {
          "type": "string",
          "description": "The text content of the message."
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the message was sent."
        }
      },
      "required": ["authorId", "authorName", "text", "timestamp"]
    },
    "ModerationLog": {
        "title": "Moderation Log",
        "description": "Stores the result of an AI moderation check for a message.",
        "type": "object",
        "properties": {
            "msgId": { "type": "string" },
            "chatId": { "type": "string" },
            "fromUid": { "type": "string" },
            "text": { "type": "string" },
            "verdict": { "type": "string", "enum": ["allowed", "blocked", "review", "warn", "quarantine", "escalate"] },
            "action": { "type": "string", "enum": ["none", "flag", "block_and_flag"], "description": "The recommended action to take." },
            "category": { "type": "string", "enum": ["none", "payment_request", "external_contact", "off_topic", "abuse"], "description": "The primary category of the detected infraction." },
            "score": { "type": "number" },
            "timestamp": { "type": "string", "format": "date-time" }
        },
        "required": ["msgId", "chatId", "fromUid", "text", "verdict", "timestamp", "score", "category", "action"]
    },
    "AiFlag": {
        "title": "AI Flag",
        "description": "Stores messages flagged by the AI for review or because they were blocked.",
        "type": "object",
        "properties": {
            "msgId": { "type": "string" },
            "chatId": { "type": "string" },
            "fromUid": { "type": "string" },
            "reason": { "type": "string", "description": "The primary category that triggered the flag." },
            "severity": { "type": "string", "enum": ["low", "medium", "high"] },
            "status": { "type": "string", "enum": ["pending_review", "resolved", "dismissed"] },
            "timestamp": { "type": "string", "format": "date-time" }
        },
        "required": ["msgId", "chatId", "fromUid", "reason", "severity", "status", "timestamp"]
    },
    "ModerationAppeal": {
        "title": "Moderation Appeal",
        "description": "A user's request to review a moderation action.",
        "type": "object",
        "properties": {
            "userId": { "type": "string", "description": "The UID of the user making the appeal." },
            "flagId": { "type": "string", "description": "The ID of the AiFlag being appealed." },
            "reason": { "type": "string", "description": "The user's justification for the appeal." },
            "status": { "type": "string", "enum": ["pending", "approved", "rejected"], "description": "The status of the appeal." },
            "createdAt": { "type": "string", "format": "date-time" }
        },
        "required": ["userId", "flagId", "reason", "status", "createdAt"]
    },
    "ContentIndex": {
        "title": "Content Index",
        "description": "A summary document of all educational content on the platform.",
        "type": "object",
        "properties": {
            "lastSyncedAt": { "type": "string", "format": "date-time" },
            "counts": {
                "type": "object",
                "properties": {
                    "categories": { "type": "number" },
                    "formations": { "type": "number" },
                    "modules": { "type": "number" },
                    "videos": { "type": "number" }
                },
                "required": ["categories", "formations", "modules", "videos"]
            },
            "summary": {
                "type": "object",
                "additionalProperties": {
                    "type": "object",
                    "properties": {
                        "title": { "type": "string" },
                        "shortSummary": { "type": "string" },
                        "keywords": { "type": "array", "items": { "type": "string" } }
                    },
                    "required": ["title", "shortSummary"]
                }
            }
        },
        "required": ["lastSyncedAt", "counts", "summary"]
    },
    "Embedding": {
        "title": "Embedding",
        "description": "Represents a vector embedding for a piece of content.",
        "type": "object",
        "properties": {
            "type": { "type": "string", "enum": ["video", "module", "formation"] },
            "text": { "type": "string", "description": "The source text that was embedded." },
            "embedding": { "type": "array", "items": { "type": "number" } },
            "createdAt": { "type": "string", "format": "date-time" },
            "updatedAt": { "type": "string", "format": "date-time" }
        },
        "required": ["type", "text", "embedding", "createdAt", "updatedAt"]
    },
    "TutorFeedback": {
        "title": "Tutor Feedback",
        "description": "Represents feedback on an AI tutor's response.",
        "type": "object",
        "properties": {
            "userId": { "type": "string" },
            "formationId": { "type": "string" },
            "query": { "type": "string" },
            "answer": { "type": "string" },
            "isHelpful": { "type": "boolean" },
            "notes": { "type": "string" },
            "createdAt": { "type": "string", "format": "date-time" }
        },
        "required": ["userId", "query", "answer", "isHelpful", "createdAt"]
    }
  },
  "auth": {
    "providers": [
      "email"
    ]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": {
        "$ref": "#/entities/UserProfile"
      },
      "description": "Stores public profile information for each user."
    },
    "/instructors/{instructorId}": {
        "schema": { "$ref": "#/entities/InstructorProfile" },
        "description": "Stores public profile information for each instructor."
    },
    "/categories/{categoryId}": {
        "schema": { "$ref": "#/entities/Category" },
        "description": "Stores all course categories."
    },
    "/formations/{formationId}": {
      "schema": {
        "$ref": "#/entities/Course"
      },
      "description": "Stores all the available courses on the platform."
    },
     "/formations/{formationId}/modules/{moduleId}": {
      "schema": { "$ref": "#/entities/Module" },
      "description": "Stores all modules for a specific course."
    },
    "/formations/{formationId}/modules/{moduleId}/videos/{videoId}": {
      "schema": { "$ref": "#/entities/Video" },
      "description": "Stores all videos for a specific module."
    },
    "/users/{userId}/progress/{progressId}": {
      "schema": {
        "$ref": "#/entities/CourseProgress"
      },
      "description": "Stores the learning progress for each user on different courses."
    },
    "/courses/{courseId}/enrollments/{enrollmentId}": {
        "schema": { "$ref": "#/entities/Enrollment" },
        "description": "Stores all enrollments for a specific course."
    },
    "/donations/{donationId}": {
        "schema": { "$ref": "#/entities/Donation" },
        "description": "Stores all donations made on the platform."
    },
    "/user_activity_logs/{logId}": {
        "schema": { "$ref": "#/entities/UserActivityLog" },
        "description": "Stores a chronological log of all important user actions."
    },
    "/admin_notifications/{notificationId}": {
        "schema": { "$ref": "#/entities/AdminNotification" },
        "description": "Stores notifications intended for platform administrators."
    },
    "/instructor_requests/{requestId}": {
      "schema": { "$ref": "#/entities/InstructorRequest" },
      "description": "Stores requests from students to become instructors."
    },
    "/community_posts/{postId}": {
      "schema": { "$ref": "#/entities/CommunityPost" },
      "description": "Stores all discussion posts in the community forum."
    },
    "/friendRequests/{requestId}": {
      "schema": { "$ref": "#/entities/FriendRequest" },
      "description": "Stores all friend requests between users."
    },
    "/chats/{chatId}": {
      "schema": { "$ref": "#/entities/Chat" },
      "description": "Stores metadata for each private conversation."
    },
    "/chats/{chatId}/messages/{messageId}": {
      "schema": { "$ref": "#/entities/Message" },
      "description": "Stores all messages for a specific chat."
    },
    "/notifications/{notificationId}": {
      "schema": { "$ref": "#/entities/Notification" },
      "description": "Stores notifications for users, such as friend requests."
    },
    "/group_chats/{chatId}": {
      "schema": { "$ref": "#/entities/GroupChat" },
      "description": "Stores metadata for each formation's group chat."
    },
    "/group_chats/{chatId}/messages/{messageId}": {
      "schema": { "$ref": "#/entities/GroupMessage" },
      "description": "Stores all messages for a specific group chat."
    },
    "/moderationLogs/{logId}": {
        "schema": { "$ref": "#/entities/ModerationLog" },
        "description": "Stores the results of AI content moderation for chat messages."
    },
    "/aiFlags/{flagId}": {
        "schema": { "$ref": "#/entities/AiFlag" },
        "description": "Stores messages flagged by the AI for review or action."
    },
    "/moderationAppeals/{appealId}": {
        "schema": { "$ref": "#/entities/ModerationAppeal" },
        "description": "Stores user appeals against moderation actions."
    },
    "/meta/contentIndex": {
        "schema": { "$ref": "#/entities/ContentIndex" },
        "description": "Singleton document containing a summary of all platform content."
    },
    "/embeddings/{embeddingId}": {
        "schema": { "$ref": "#/entities/Embedding" },
        "description": "Stores vector embeddings for content to be used in semantic search."
    },
    "/tutorFeedbacks/{feedbackId}": {
        "schema": { "$ref": "#/entities/TutorFeedback" },
        "description": "Stores user feedback on AI tutor responses."
    }
  }
}
